{"pageProps":{"markdoc":{"content":[{"$$mdtype":"Tag","name":"p","attributes":{},"children":["A devfile allows to specify commands to be available for execution in a"," ","workspace. Every command can contain a subset of actions, which are"," ","related to a specific component in whose container it will be executed."]},{"$$mdtype":"Tag","name":"h2","attributes":{"id":"prerequisites"},"children":["Prerequisites"]},{"$$mdtype":"Tag","name":"ul","attributes":{},"children":[{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"p","attributes":{},"children":[{"$$mdtype":"Tag","name":"Link","attributes":{"href":"./versions"},"children":["Adding schema version"]}]}]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"p","attributes":{},"children":[{"$$mdtype":"Tag","name":"Link","attributes":{"href":"./metadata"},"children":["Adding a name"]}]}]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"p","attributes":{},"children":[{"$$mdtype":"Tag","name":"Link","attributes":{"href":"./adding-projects"},"children":["Adding projects"]}]}]}]},{"$$mdtype":"Tag","name":"h2","attributes":{"id":"procedure"},"children":["Procedure"]},{"$$mdtype":"Tag","name":"ol","attributes":{},"children":[{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"p","attributes":{},"children":["Add a ",{"$$mdtype":"Tag","name":"code","attributes":{},"children":["commands"]}," section in the devfile, containing a list of one or"," ","more commands."]}]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"p","attributes":{},"children":["For each command, define an unique value for the mandatory ",{"$$mdtype":"Tag","name":"code","attributes":{},"children":["id"]}," ","attribute."]}]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"p","attributes":{},"children":["For each command, define a mandatory type of one of the following"," ","types: ",{"$$mdtype":"Tag","name":"code","attributes":{},"children":["exec"]}," or ",{"$$mdtype":"Tag","name":"code","attributes":{},"children":["vscode-tasks"]},"."]},{"$$mdtype":"Tag","name":"Fence","attributes":{"language":"yaml","title":"Sample command","filename":"devfile.yaml"},"children":["commands:\n  - id: build\n    exec:\n    component: mysql\n    commandLine: mvn clean\n    workingDir: /projects/spring-petclinic\n"]}]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"p","attributes":{},"children":["Define attributes for the ",{"$$mdtype":"Tag","name":"code","attributes":{},"children":["exec"]}," command to run using the default"," ","shell in the container."]},{"$$mdtype":"Tag","name":"ul","attributes":{},"children":[{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"p","attributes":{},"children":["A ",{"$$mdtype":"Tag","name":"code","attributes":{},"children":["commandLine"]}," attribute that is a command to execute."]}]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"p","attributes":{},"children":["A ",{"$$mdtype":"Tag","name":"code","attributes":{},"children":["component"]}," attribute that specifies the container in which to"," ","execute the command."]}]}]},{"$$mdtype":"Tag","name":"Fence","attributes":{"language":"yaml","filename":"devfile.yaml"},"children":["schemaVersion: 2.0.0\nmetadata:\n  name: MyDevfile\nprojects:\n  - name: my-go-project\n    clonePath: go/src/github.com/acme/my-go-project\n    git:\n      remotes:\n        origin: \"https://github.com/acme/my-go-project.git\"\ncomponents:\n  - name: go-cli\n    container:\n      image: golang\n      memoryLimit: 512Mi\n      mountSources: true\n      command: ['sleep', 'infinity']\n      env:\n        - name: GOPATH\n          value: $(PROJECTS_ROOT)/go\n        - name: GOCACHE\n          value: /tmp/go-cache\ncommands:\n  - id: compile and run\n    exec:\n      component: go-cli\n      commandLine: \"go get -d && go run main.go\"\n      workingDir: \"${PROJECTS_ROOT}/src/github.com/acme/my-go-project\"\n      runAsUser: root\n"]},{"$$mdtype":"Tag","name":"ul","attributes":{},"children":[{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"p","attributes":{},"children":["Any component on which commands are executed must define a"," ",{"$$mdtype":"Tag","name":"code","attributes":{},"children":["name"]}," attribute. This name is used to reference the component"," ","in the command definition. Example: ",{"$$mdtype":"Tag","name":"code","attributes":{},"children":["name: go-cli"]}," in the"," ","component definition and ",{"$$mdtype":"Tag","name":"code","attributes":{},"children":["component: go-cli"]}," in the command"," ","definition."]}]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"p","attributes":{},"children":["A command can have only one action, though you can use"," ",{"$$mdtype":"Tag","name":"code","attributes":{},"children":["composite"]}," commands to execute several commands either"," ","sequentially or in parallel."]}]}]}]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"p","attributes":{},"children":["Define attributes for the ",{"$$mdtype":"Tag","name":"code","attributes":{},"children":["vscode-task"]}," or ",{"$$mdtype":"Tag","name":"code","attributes":{},"children":["vscode-launch"]}," command"," ","to run using the Editor."]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["If the editor in the workspace supports it, the devfile can specify"," ","additional configuration in the editor-specific format. This is"," ","dependent on the integration code present in the workspace editor"," ","itself and so is not a generic mechanism."]},{"$$mdtype":"Tag","name":"Fence","attributes":{"language":"yaml","filename":"devfile.yaml"},"children":["schemaVersion: 2.0.0\nmetadata:\n  name: MyDevfile\nprojects:\n  - name: my-go-project\n    clonePath: go/src/github.com/acme/my-go-project\n    git:\n      remotes:\n        origin: \"https://github.com/acme/my-go-project.git\"\ncommands:\n  - id: task\n    vscode-task:\n      name: tasks\n      referenceContent: >\n          {\n              \"version\": \"2.0.0\",\n              \"tasks\": [\n                  {\n                      \"label\": \"create test file\",\n                      \"type\": \"shell\",\n                      \"command\": \"touch ${workspaceFolder}/test.file\"\n                  }\n              ]\n          }\n"]}]}]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["This example shows association of a ",{"$$mdtype":"Tag","name":"code","attributes":{},"children":["tasks.json"]}," file with a devfile."," ","Notice the ",{"$$mdtype":"Tag","name":"code","attributes":{},"children":["vscode-task"]}," type that instructs the editor to interpret"," ","this command as a tasks definition and ",{"$$mdtype":"Tag","name":"code","attributes":{},"children":["referenceContent"]}," attribute that"," ","contains the contents of the file itself. You can also save this file"," ","separately from the devfile and use ",{"$$mdtype":"Tag","name":"code","attributes":{},"children":["reference"]}," attribute to specify a"," ","relative or absolute URL to it."]},{"$$mdtype":"Tag","name":"ol","attributes":{},"children":[{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"p","attributes":{},"children":["Command group"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["A given command can be assigned to one or more groups that"," ","represents the nature of the command. The support groups are:"," ",{"$$mdtype":"Tag","name":"code","attributes":{},"children":["build"]},", ",{"$$mdtype":"Tag","name":"code","attributes":{},"children":["run"]},", ",{"$$mdtype":"Tag","name":"code","attributes":{},"children":["test"]}," and ",{"$$mdtype":"Tag","name":"code","attributes":{},"children":["debug"]},". For each of the groups, one"," ","default command can be defined in each group by specifying the"," ",{"$$mdtype":"Tag","name":"code","attributes":{},"children":["isDefault"]}," value."]},{"$$mdtype":"Tag","name":"Fence","attributes":{"language":"yaml","filename":"devfile.yaml"},"children":["schemaVersion: 2.0.0\nmetadata:\n  name: MyDevfile\nprojects:\n  - name: my-maven-project\n    clonePath: maven/src/github.com/acme/my-maven-project\n    git:\n      remotes:\n        origin: \"https://github.com/acme/my-maven-project.git\"\ncomponents:\n  - name: maven\n    container:\n      image: eclipse/maven-jdk8:latest\n      mountSources: true\n      command: ['tail']\ncommands:\n  - id: package\n    exec:\n      component: maven\n      commandLine: \"mvn package\"\n      group:\n        kind: build\n  - id: install\n    exec:\n      component: maven\n      commandLine: \"mvn install\"\n      group:\n        kind: build\n        isDefault: true\n"]}]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"p","attributes":{},"children":["Composite command"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["A composite command can be defined to chain multiple commands"," ","together. The individual commands that are called from a composite"," ","command can be referenced by the ",{"$$mdtype":"Tag","name":"code","attributes":{},"children":["name"]}," of the command. A ",{"$$mdtype":"Tag","name":"code","attributes":{},"children":["parallel"]}," ","boolean can be specified to determine if the commands within a"," ","composite command are being executed sequentially or in parallel."]},{"$$mdtype":"Tag","name":"Fence","attributes":{"language":"yaml","filename":"devfile.yaml"},"children":["schemaVersion: 2.0.0\nmetadata:\n  name: MyDevfile\nprojects:\n  - name: my-maven-project\n    clonePath: maven/src/github.com/acme/my-maven-project\n    git:\n      remotes:\n        origin: \"https://github.com/acme/my-maven-project.git\"\ncomponents:\n  - name: maven\n    container:\n      image: eclipse/maven-jdk8:latest\n      mountSources: true\n      command: ['tail']\ncommands:\n  - id: package\n    exec:\n      component: maven\n      commandLine: \"mvn package\"\n      group:\n        kind: build\n  - id: install\n    exec:\n      component: maven\n      commandLine: \"mvn install\"\n      group:\n        kind: build\n        isDefault: true\n  - id: installAndPackage\n    composite:\n      commands:\n        - install\n        - package\n      parallel: false\n"]}]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"p","attributes":{},"children":["Command preview URL"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["It is possible to specify a preview URL for commands that expose web"," ","UI. This URL is offered for opening when the command is executed."]},{"$$mdtype":"Tag","name":"Fence","attributes":{"language":"yaml","filename":"devfile.yaml"},"children":["commands:\n    - id: tasks\n      exec:\n        previewUrl:\n          port: 8080     \n          path: /myweb   \n        component: go-cli\n        commandLine: \"go run webserver.go\"\n        workingDir: ${PROJECTS_ROOT}/webserver\n"]},{"$$mdtype":"Tag","name":"ul","attributes":{},"children":[{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"p","attributes":{},"children":["TCP port where the application listens. Mandatory parameter."]}]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"p","attributes":{},"children":["The path part of the URL to the UI. Optional parameter. The"," ","default is root (",{"$$mdtype":"Tag","name":"code","attributes":{},"children":["/"]},")."]}]}]}]}]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["The example above opens ",{"$$mdtype":"Tag","name":"code","attributes":{},"children":["++http://__<server-domain>__/myweb++"]},", where"," ",{"$$mdtype":"Tag","name":"code","attributes":{},"children":["_<server-domain>_"]}," is the URL to the dynamically created Kubernetes"," ","Ingress or OpenShift Route."]},{"$$mdtype":"Tag","name":"h2","attributes":{"id":"additional-resources"},"children":["Additional resources"]},{"$$mdtype":"Tag","name":"ul","attributes":{},"children":[{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"p","attributes":{},"children":[{"$$mdtype":"Tag","name":"Link","attributes":{"href":"./devfile-schema"},"children":["API reference"]}]}]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"p","attributes":{},"children":[{"$$mdtype":"Tag","name":"Link","attributes":{"href":"./devfile-samples"},"children":["Devfile samples"]}]}]}]}],"frontmatter":{"title":"Adding commands","description":"Adding commands"},"file":{"path":"/docs/2.0.0/adding-commands.md"}}},"__N_SSG":true}